<div class="login-container">
  <div class="os-window os-auth-window">
    <header class="mb-10">
      <div class="vibe-auth-icon">
        <i class="pi pi-sparkles text-accent text-2xl"></i>
      </div>
      <h2 class="text-4xl font-black uppercase tracking-[-0.05em] mb-3">
        {{ mode === 'login' ? 'Vibe' : 'Join' }}
        <span class="text-accent italic">{{ mode === 'login' ? 'In' : 'Assemble' }}</span>
      </h2>
      <p class="text-[12px] font-medium text-white/30 tracking-wide">
        {{
          mode === 'login'
            ? 'Welcome back to the vibe. Ready to connect?'
            : 'Start your journey and vibe with the community.'
        }}
      </p>
    </header>

    <form (ngSubmit)="onSubmit()" [formGroup]="form">
      <!-- Username -->
      <div class="os-input-group">
        <label class="text-[9px] font-black uppercase tracking-[0.2em] text-white/20 mb-2 block"
          >Username</label
        >
        <div class="relative group">
          <input
            type="text"
            formControlName="username"
            (input)="updateErrorMsg('username')"
            placeholder="Your vibe ID..."
            class="vibe-input"
          />
          <i
            class="pi pi-user absolute right-6 top-1/2 -translate-y-1/2 text-white/10 group-focus-within:text-accent transition-colors text-xs"
          ></i>
        </div>
        @if (form.controls['username'].invalid && form.controls['username'].touched) {
          <p class="text-[8px] font-black uppercase text-red-500/80 px-1 mt-2 tracking-widest">
            {{ errorMsg.username() }}
          </p>
        }
      </div>

      <!-- Password -->
      <div class="os-input-group">
        <label class="text-[9px] font-black uppercase tracking-[0.2em] text-white/20 mb-2 block"
          >Password</label
        >
        <div class="relative group">
          <input
            type="password"
            formControlName="password"
            (input)="updateErrorMsg('password')"
            placeholder="••••••••"
            class="vibe-input"
          />
          <i
            class="pi pi-lock absolute right-6 top-1/2 -translate-y-1/2 text-white/10 group-focus-within:text-accent transition-colors text-xs"
          ></i>
        </div>
        @if (form.controls['password'].invalid && form.controls['password'].touched) {
          <p class="text-[8px] font-black uppercase text-red-500/80 px-1 mt-2 tracking-widest">
            {{ errorMsg.password() }}
          </p>
        }
      </div>

      <!-- Register Fields -->
      @if (mode !== 'login') {
        <div class="os-input-group">
          <label class="text-[9px] font-black uppercase tracking-[0.2em] text-white/20 mb-2 block"
            >Confirm Password</label
          >
          <input
            type="password"
            formControlName="cf_password"
            (input)="updateErrorMsg('cf_password')"
            placeholder="••••••••"
            class="vibe-input"
          />
          @if (form.controls['cf_password'].invalid && form.controls['cf_password'].touched) {
            <p class="text-[8px] font-black uppercase text-red-500/80 px-1 mt-2 tracking-widest">
              {{ errorMsg.cf_password() }}
            </p>
          }
        </div>

        <div class="os-input-group">
          <label class="text-[9px] font-black uppercase tracking-[0.2em] text-white/20 mb-2 block"
            >Display Name</label
          >
          <input
            type="text"
            formControlName="display_name"
            (input)="updateErrorMsg('display_name')"
            placeholder="How others see you..."
            class="vibe-input"
          />
          @if (form.controls['display_name'].invalid && form.controls['display_name'].touched) {
            <p class="text-[8px] font-black uppercase text-red-500/80 px-1 mt-2 tracking-widest">
              {{ errorMsg.display_name() }}
            </p>
          }
        </div>
      }

      <button
        type="submit"
        pButton
        [label]="mode === 'login' ? 'VIBE_IN' : 'START_VIBING'"
        [disabled]="!form.valid"
        class="w-full h-14 p-button-primary !rounded-xl !text-[10px] !font-black !tracking-[0.4em] mb-4 mt-2"
      ></button>

      @if (errorMsg.server()) {
        <div
          class="p-5 rounded-2xl bg-red-900/10 border border-red-500/20 text-[10px] font-black uppercase text-red-500 text-center"
        >
          {{ errorMsg.server() }}
        </div>
      }
    </form>

    <footer class="mt-12 text-center pt-8 border-t border-white/5">
      <p class="text-[11px] font-black uppercase tracking-[0.1em] text-white/20">
        {{ mode === 'login' ? 'New to Vibe Assemble?' : 'Already vibing with us?' }}
        <span class="text-accent cursor-pointer hover:underline ml-3" (click)="toggleMode()">
          {{ mode === 'login' ? 'Create Account' : 'Login Instead' }}
        </span>
      </p>
    </footer>
  </div>
</div>
