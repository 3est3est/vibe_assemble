<div class="login-container">
  <div class="bg-mesh"></div>

  <div class="os-window-base os-auth-window">
    <header class="mb-16 text-center">
      <div class="os-auth-icon">
        <i class="pi pi-shield text-black text-3xl"></i>
      </div>
      <h2 class="text-4xl font-black uppercase tracking-[-0.04em] mb-4">
        {{ mode === 'login' ? 'System' : 'Initialize' }}
        <span class="opacity-30 italic">{{ mode === 'login' ? 'Auth' : 'Vibe' }}</span>
      </h2>
      <p class="os-label opacity-40">
        {{
          mode === 'login'
            ? 'Authorize signal for network access.'
            : 'Initialize presence in the vibe sector.'
        }}
      </p>
    </header>

    <form (ngSubmit)="onSubmit()" [formGroup]="form">
      <!-- Username -->
      <div class="os-input-group">
        <label class="os-label text-zinc-500">Operative_ID</label>
        <div class="relative group">
          <input
            type="text"
            formControlName="username"
            (input)="updateErrorMsg('username')"
            placeholder="ENTER_ID..."
          />
          <i
            class="pi pi-user absolute right-6 top-1/2 -translate-y-1/2 text-zinc-800 group-focus-within:text-white transition-colors"
          ></i>
        </div>
        @if (form.controls['username'].invalid && form.controls['username'].touched) {
          <p class="text-[9px] font-black uppercase text-red-500/80 px-1 tracking-widest">
            {{ errorMsg.username() }}
          </p>
        }
      </div>

      <!-- Password -->
      <div class="os-input-group">
        <label class="os-label text-zinc-500">Access_Key</label>
        <div class="relative group">
          <input
            type="password"
            formControlName="password"
            (input)="updateErrorMsg('password')"
            placeholder="••••••••"
          />
          <i
            class="pi pi-lock absolute right-6 top-1/2 -translate-y-1/2 text-zinc-800 group-focus-within:text-white transition-colors"
          ></i>
        </div>
        @if (form.controls['password'].invalid && form.controls['password'].touched) {
          <p class="text-[9px] font-black uppercase text-red-500/80 px-1 tracking-widest">
            {{ errorMsg.password() }}
          </p>
        }
      </div>

      <!-- Register Fields -->
      @if (mode !== 'login') {
        <div class="os-input-group">
          <label class="os-label text-zinc-500">Confirm_Key</label>
          <input
            type="password"
            formControlName="cf_password"
            (input)="updateErrorMsg('cf_password')"
            placeholder="••••••••"
          />
          @if (form.controls['cf_password'].invalid && form.controls['cf_password'].touched) {
            <p class="text-[9px] font-black uppercase text-red-500/80 px-1 tracking-widest">
              {{ errorMsg.cf_password() }}
            </p>
          }
        </div>

        <div class="os-input-group">
          <label class="os-label text-zinc-500">Display_Alias</label>
          <input
            type="text"
            formControlName="display_name"
            (input)="updateErrorMsg('display_name')"
            placeholder="ENTER_ALIAS..."
          />
          @if (form.controls['display_name'].invalid && form.controls['display_name'].touched) {
            <p class="text-[9px] font-black uppercase text-red-500/80 px-1 tracking-widest">
              {{ errorMsg.display_name() }}
            </p>
          }
        </div>
      }

      <button
        type="submit"
        pButton
        [label]="mode === 'login' ? 'AUTHORIZE_SESSION' : 'INITIALIZE_ACCOUNT'"
        [disabled]="!form.valid"
        class="w-full h-16 p-button-primary rounded-2xl text-[11px] font-black tracking-[0.4em] mb-4"
      ></button>

      @if (errorMsg.server()) {
        <div
          class="p-5 rounded-2xl bg-red-900/10 border border-red-500/20 text-[10px] font-black uppercase text-red-500 text-center"
        >
          {{ errorMsg.server() }}
        </div>
      }
    </form>

    <footer class="os-auth-footer">
      <p class="os-label !mb-0 text-zinc-600">
        {{ mode === 'login' ? 'Unauthorized?' : 'Already authorized?' }}
        <span class="text-white cursor-pointer hover:underline ml-3" (click)="toggleMode()">
          {{ mode === 'login' ? 'Request Access' : 'Sign In' }}
        </span>
      </p>
    </footer>
  </div>
</div>
