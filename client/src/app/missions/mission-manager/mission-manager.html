<div class="mission-manager-container">
  <div class="godly-hero-manager">
    <div class="page-layout">
      <!-- SIDEBAR -->
      <aside class="page-sidebar">
        <div class="flex flex-col gap-1">
          <div class="os-nav-item active">
            <i class="pi pi-th-large"></i>
            <span>My Hosting</span>
          </div>
          <div class="os-nav-item" (click)="onCreate()">
            <i class="pi pi-plus-circle"></i>
            <span>Create Activity</span>
          </div>
        </div>

        <div class="mt-auto pt-6 border-t border-white/5">
          <span class="label">Activity Stats</span>
          <div class="flex items-center gap-3 px-3 mt-3">
            <div class="flex flex-col">
              <span class="text-[20px] font-bold text-white">{{ myMissions().length }}</span>
              <span class="text-[10px] text-white/40 uppercase font-bold tracking-widest"
                >Active Rooms</span
              >
            </div>
          </div>
        </div>
      </aside>

      <!-- MAIN CONTENT -->
      <section class="page-main">
        <div class="page-header">
          <h1 class="page-title">Room Manager</h1>
          <button
            pButton
            label="Host a Vibe"
            icon="pi pi-plus"
            (click)="onCreate()"
            class="shuttle-action-btn bg-accent text-white border-none py-3 px-6 rounded-xl"
            style="background-color: var(--accent) !important"
          ></button>
        </div>

        <div class="missions-grid hide-scrollbar overflow-y-auto">
          @for (mission of myMissions(); track mission.id; let i = $index) {
            <div class="mission-card-os group" [routerLink]="['/missions', mission.id]">
              <!-- Simple header for management -->
              <div class="bg-accent/10 h-2 w-full"></div>

              <div class="card-body">
                <div class="flex justify-between items-start">
                  <div class="flex flex-col gap-1">
                    <span class="text-[10px] font-black text-white/30 uppercase tracking-widest"
                      >#ROOM {{ mission.id }} â€¢ {{ mission.category }}</span
                    >
                    <h3 class="room-title">{{ mission.name }}</h3>
                  </div>
                  <div class="flex gap-2">
                    <button
                      (click)="onEdit(mission); $event.stopPropagation()"
                      class="w-8 h-8 rounded-lg bg-white/5 border border-white/5 flex items-center justify-center text-white/40 hover:text-white hover:bg-white/10 transition-all"
                    >
                      <i class="pi pi-pencil" style="font-size: 12px"></i>
                    </button>
                  </div>
                </div>

                <p class="text-[13px] text-white/50 line-clamp-2">
                  {{
                    mission.description ||
                      'Manage your activity parameters and connect with participants.'
                  }}
                </p>

                <div class="room-metadata">
                  <div
                    class="status-tag"
                    [ngClass]="
                      'status-' + (mission.status?.toLowerCase()?.replace(' ', '-') || 'open')
                    "
                  >
                    {{ mission.status }}
                  </div>
                  <div class="meta-item">
                    <i class="pi pi-users"></i>
                    <span>{{ mission.crew_count }} / {{ mission.max_crew }} joined</span>
                  </div>
                </div>
              </div>

              <div class="card-footer px-6 pb-6">
                <button
                  (click)="onDelete(mission); $event.stopPropagation()"
                  class="btn btn-ghost btn-sm w-full text-red-500/50 hover:text-red-500 hover:bg-red-500/10 rounded-xl"
                >
                  <i class="pi pi-trash mr-2"></i> Close Room
                </button>
              </div>
            </div>
          } @empty {
            <div
              class="col-span-full py-40 flex flex-col items-center justify-center gap-4 opacity-20"
            >
              <i class="pi pi-calendar-plus text-5xl"></i>
              <p class="font-bold uppercase tracking-widest text-xs">
                You're not hosting anything yet
              </p>
              <button class="btn btn-ghost btn-sm" (click)="onCreate()">
                Start your first room
              </button>
            </div>
          }
        </div>
      </section>
    </div>
  </div>
</div>
