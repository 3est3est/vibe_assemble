<div class="relative min-h-screen bg-black selection:bg-white selection:text-black">
  <div class="bg-mesh"></div>

  <div class="max-w-7xl mx-auto px-6 py-20 animate-shuttle pb-32">
    <!-- Chief Header -->
    <header class="mb-24 flex flex-col md:flex-row md:items-end justify-between gap-12">
      <div class="flex-grow">
        <div class="glass-pill mb-6 opacity-60">Command Authority</div>
        <h1 class="text-7xl font-black uppercase tracking-[-0.06em] leading-[0.85] mb-6">
          Mission <span class="opacity-40 italic">Chief</span>
        </h1>
        <p class="text-zinc-500 font-medium tracking-wide uppercase text-[10px] max-w-md">
          Manage your active operations and tactical protocols from the central command hub.
        </p>
      </div>

      <button
        pButton
        label="INITIALIZE PROTOCOL"
        icon="pi pi-plus"
        class="h-16 p-button-primary px-8 rounded-2xl text-[11px] font-black tracking-widest shadow-2xl shadow-white/5"
        (click)="onCreate()"
      ></button>
    </header>

    <!-- Missions Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      @for (mission of myMissions(); track mission.id; let i = $index) {
        <div
          class="mission-card group animate-shuttle flex flex-col h-full !p-8"
          [style.animation-delay]="i * 0.05 + 's'"
          [ngClass]="getZone(mission.category)"
          [routerLink]="['/missions', mission.id]"
          style="cursor: pointer"
        >
          <!-- 1. Meta & Actions -->
          <div class="flex items-center justify-between mb-10">
            <span
              class="text-[9px] font-bold text-zinc-500 uppercase tracking-widest px-3 py-1 bg-zinc-800/50 rounded-full border border-zinc-700/50"
            >
              {{ mission.category || 'General' }}
            </span>
            <div class="flex items-center gap-1">
              <button
                pButton
                icon="pi pi-pencil"
                class="p-button-text p-button-sm !w-9 !h-9 !p-0 text-zinc-600 hover:text-white"
                (click)="onEdit(mission); $event.stopPropagation()"
              ></button>
              <button
                pButton
                icon="pi pi-trash"
                class="p-button-text p-button-sm !w-9 !h-9 !p-0 text-zinc-600 hover:text-red-500"
                (click)="onDelete(mission); $event.stopPropagation()"
              ></button>
            </div>
          </div>

          <!-- 2. Intelligence -->
          <div class="flex-grow mb-12">
            <h3
              class="text-3xl font-black tracking-tighter leading-none mb-4 group-hover:text-white transition-colors uppercase"
            >
              {{ mission.name }}
            </h3>
            <p class="text-sm text-zinc-500 font-medium leading-relaxed line-clamp-2">
              {{
                mission.description || 'Secure intelligence frequency. Mission briefing initiated.'
              }}
            </p>
          </div>

          <!-- 3. Stats Hub -->
          <div
            class="grid grid-cols-2 gap-px bg-zinc-800/20 rounded-2xl overflow-hidden border border-zinc-800/50 mb-10"
          >
            <div class="p-5 flex flex-col gap-1.5 bg-zinc-900/40">
              <span class="text-[8px] font-bold text-zinc-600 uppercase tracking-widest"
                >Protocol</span
              >
              <div class="flex items-center gap-2">
                <div
                  [class]="
                    'w-1.5 h-1.5 rounded-full ' +
                    (mission.status === 'Open'
                      ? 'bg-white shadow-[0_0_8px_rgba(255,255,255,0.4)]'
                      : 'bg-zinc-700')
                  "
                ></div>
                <span class="text-[10px] font-bold text-zinc-400">{{ mission.status }}</span>
              </div>
            </div>
            <div class="p-5 flex flex-col gap-1.5 bg-zinc-900/40">
              <span class="text-[8px] font-bold text-zinc-600 uppercase tracking-widest"
                >Integrity</span
              >
              <div class="flex items-center gap-2">
                <i class="pi pi-users text-[10px] text-zinc-600"></i>
                <span class="text-[10px] font-bold text-zinc-400">
                  {{ mission.crew_count || 0 }}/{{ mission.max_crew }}
                </span>
              </div>
            </div>
          </div>

          <!-- 4. Deployment -->
          <button
            pButton
            label="ENTER COMMAND ROOM"
            class="w-full h-14 p-button-outlined border-zinc-800 group-hover:border-zinc-500"
          ></button>
        </div>
      } @empty {
        <div
          class="col-span-full py-40 flex flex-col items-center justify-center text-center animate-shuttle"
        >
          <div
            class="w-20 h-20 rounded-full border border-zinc-800 flex items-center justify-center mb-8 bg-zinc-900/50"
          >
            <i class="pi pi-plus text-zinc-700 text-2xl"></i>
          </div>
          <h3 class="text-2xl font-black uppercase tracking-tight mb-2">No Active Operations</h3>
          <p class="text-[10px] font-bold text-zinc-600 uppercase tracking-[0.3em]">
            Initialize a new protocol to begin sector surveillance.
          </p>
        </div>
      }
    </div>
  </div>
</div>
