<mat-sidenav-container class="drawer-container" autosize>
  <mat-sidenav #drawer class="app-sidebar" mode="over">
    <div class="sidebar-header">
      <h3>MENU</h3>
      <button mat-icon-button (click)="drawer.toggle()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="nav-content">
      <nav class="nav-group" (click)="drawer.close()">
        <a
          class="nav-item"
          routerLink="/"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
        >
          <mat-icon>home</mat-icon>
          <span>Home</span>
        </a>

        @if (display_name()) {
          <div class="section-label">MAIN</div>
          <a class="nav-item" routerLink="/missions" routerLinkActive="active">
            <mat-icon>explore</mat-icon>
            <span>Explore</span>
          </a>
          <a class="nav-item" routerLink="/chief" routerLinkActive="active">
            <mat-icon>event_available</mat-icon>
            <span>My Activities</span>
          </a>

          <div class="section-label">SOCIAL</div>
          <a class="nav-item" routerLink="/my-crew" routerLinkActive="active">
            <mat-icon>groups</mat-icon>
            <span>My Crew</span>
          </a>
          <a class="nav-item" routerLink="/network" routerLinkActive="active">
            <mat-icon>public</mat-icon>
            <span>Members</span>
          </a>
          <a class="nav-item" routerLink="/dashboard" routerLinkActive="active">
            <mat-icon>dashboard</mat-icon>
            <span>Stats</span>
          </a>
        }
      </nav>
    </div>

    @if (display_name()) {
      <div class="sidebar-footer">
        <button class="logout-btn" (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span>Logout</span>
        </button>
      </div>
    }
  </mat-sidenav>

  <mat-sidenav-content class="app-content">
    <mat-toolbar class="top-navbar">
      <div class="left-section">
        @if (display_name()) {
          <!-- Always visible menu button for sidebar -->
          <button mat-icon-button (click)="drawer.toggle()" class="menu-btn">
            <mat-icon>menu</mat-icon>
          </button>
        }
        <a routerLink="/" class="logo-text">Vibe Assemble</a>

        @if (display_name()) {
          <nav class="desktop-nav">
            <a routerLink="/missions" routerLinkActive="active" class="nav-link">
              <mat-icon>explore</mat-icon> Explore
            </a>
            <a routerLink="/chief" routerLinkActive="active" class="nav-link">
              <mat-icon>event_available</mat-icon> My Activities
            </a>
            <a routerLink="/my-crew" routerLinkActive="active" class="nav-link">
              <mat-icon>groups</mat-icon> My Crew
            </a>
            <a routerLink="/network" routerLinkActive="active" class="nav-link">
              <mat-icon>public</mat-icon> Members
            </a>
            <a routerLink="/dashboard" routerLinkActive="active" class="nav-link">
              <mat-icon>dashboard</mat-icon> Dashboard
            </a>
          </nav>
        } @else {
          <!-- Guest Navigation: visible before login -->
          <nav class="desktop-nav">
            <a routerLink="/missions" class="nav-link"> <mat-icon>explore</mat-icon> Explore </a>
          </nav>
        }
      </div>

      <div class="spacer"></div>

      @if (display_name()) {
        <div class="right-section">
          <app-online-users></app-online-users>
          <app-notification-bell></app-notification-bell>

          <div class="user-profile" [routerLink]="['/profile']">
            <img [src]="avatar_url()" alt="avatar" />
            <span class="user-name">{{ display_name() }}</span>
            <mat-icon class="chevron-down">expand_more</mat-icon>
          </div>
        </div>
      } @else {
        <div class="right-section">
          <a routerLink="/login" class="login-btn">
            <mat-icon>login</mat-icon>
            <span>Login</span>
          </a>
        </div>
      }
    </mat-toolbar>

    <!-- Content Projection -->
    <ng-content></ng-content>
  </mat-sidenav-content>
</mat-sidenav-container>
