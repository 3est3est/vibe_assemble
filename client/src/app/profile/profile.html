<div class="profile-container">
  <div class="bg-mesh"></div>

  <!-- ðŸ·ï¸ Presence Cursor (Self) -->
  <div class="presence-tag top-[15%] right-[20%] animate-pulse">
    <div class="presence-label">{{ display_name() }}</div>
    <div class="presence-pointer"></div>
  </div>

  <div class="godly-hero-profile">
    <!-- OS WINDOW -->
    <main class="os-window-base os-profile-window">
      <!-- WINDOW SIDEBAR -->
      <aside class="os-sidebar-base os-profile-sidebar">
        <div class="avatar-wrapper-os">
          <img [src]="avatar_url()" class="avatar-img-os" />
          @if (isOwnProfile()) {
            <button
              (click)="openAvatarDialog()"
              class="absolute -bottom-2 -right-2 w-10 h-10 bg-white text-black rounded-lg flex items-center justify-center border-4 border-black border-[rgba(0,0,0,0.5)]"
            >
              <i class="pi pi-camera text-xs"></i>
            </button>
          }
        </div>

        <div class="flex flex-col gap-1">
          <div class="os-profile-nav-item active">
            <i class="pi pi-user"></i>
            <span>Overview</span>
          </div>
          <div class="os-profile-nav-item">
            <i class="pi pi-history"></i>
            <span>History</span>
          </div>
          <div class="os-profile-nav-item">
            <i class="pi pi-shield"></i>
            <span>Security</span>
          </div>
        </div>

        <div class="mt-auto pt-8 border-t border-white/5">
          <span class="os-label">Operative_Rank</span>
          <div class="flex items-center gap-3">
            <div class="presence-dot-os"></div>
            <span class="text-[10px] font-black text-white uppercase tracking-widest">{{
              rank()
            }}</span>
          </div>
        </div>
      </aside>

      <!-- WINDOW CONTENT -->
      <section class="os-profile-main flex flex-col">
        <div class="flex justify-between items-start mb-16">
          <div class="flex flex-col pt-4">
            <span class="os-label">Identity_Profile</span>
            <h1 class="os-title-large mb-4">{{ display_name() }}</h1>
            <div class="flex items-center gap-4 text-zinc-600">
              <span class="text-[10px] uppercase font-black tracking-widest">Sector_Active</span>
              <div class="h-1 w-1 rounded-full bg-zinc-800"></div>
              <span class="text-[10px] uppercase font-black tracking-widest"
                >ID_{{ display_name().substring(0, 4).toUpperCase() }}</span
              >
            </div>
          </div>

          <div class="flex gap-3">
            @if (isOwnProfile()) {
              <button
                pButton
                label="EDIT PROFILE"
                icon="pi pi-pencil"
                (click)="openEditProfileDialog()"
                class="shuttle-action-btn"
              ></button>
            } @else {
              @if (friendshipStatus() === 'accepted') {
                <button
                  pButton
                  label="MESSAGE"
                  icon="pi pi-comments"
                  (click)="openChat()"
                  class="shuttle-action-btn"
                ></button>
              } @else if (friendshipStatus() === 'pending') {
                <button
                  pButton
                  label="PENDING"
                  icon="pi pi-clock"
                  disabled
                  class="shuttle-action-btn opacity-40"
                ></button>
              } @else {
                <button
                  pButton
                  label="ADD FRIEND"
                  icon="pi pi-user-plus"
                  (click)="addFriend()"
                  class="shuttle-action-btn"
                ></button>
              }
            }
          </div>
        </div>

        <!-- BENTO STATS -->
        <div class="grid grid-cols-3 gap-6 mb-12">
          <div class="os-glass-card p-8 group">
            <span class="os-label !mb-2 opacity-40 group-hover:opacity-100 transition-opacity"
              >Total_Vibes</span
            >
            <div class="text-5xl font-black text-white italic tracking-tighter">
              {{ stats().hosted + stats().joined }}
            </div>
          </div>
          <div class="os-glass-card p-8 group">
            <span class="os-label !mb-2 opacity-40 group-hover:opacity-100 transition-opacity"
              >Hosted</span
            >
            <div class="text-5xl font-black text-zinc-500 italic tracking-tighter">
              {{ stats().hosted }}
            </div>
          </div>
          <div class="os-glass-card p-8 group">
            <span class="os-label !mb-2 opacity-40 group-hover:opacity-100 transition-opacity"
              >Joined</span
            >
            <div class="text-5xl font-black text-zinc-500 italic tracking-tighter">
              {{ stats().joined }}
            </div>
          </div>
        </div>

        <!-- BIO -->
        <div
          class="os-glass-card p-10 mb-12 relative overflow-hidden flex flex-col justify-between min-h-[250px]"
        >
          <span class="os-label">Bio_Database</span>
          <p class="text-2xl font-black leading-tight text-zinc-300 italic max-w-2xl">
            "{{ bio() || "Hey! I'm here to vibe. Let's do something cool together." }}"
          </p>
          <div class="flex gap-4 mt-10">
            <div
              class="px-5 py-2.5 rounded-xl bg-white/[0.03] border border-white/5 text-[9px] font-black uppercase tracking-widest text-zinc-600 hover:text-white transition-all cursor-default"
            >
              #Operative
            </div>
            <div
              class="px-5 py-2.5 rounded-xl bg-white/[0.03] border border-white/5 text-[9px] font-black uppercase tracking-widest text-zinc-600 hover:text-white transition-all cursor-default"
            >
              #Vibe_Official
            </div>
          </div>
        </div>

        <!-- SOCIAL GRID -->
        <div class="grid grid-cols-2 gap-6 pb-20">
          <div class="os-glass-card social-pill-os group">
            <div class="icon-box"><i class="pi pi-discord"></i></div>
            <div class="flex flex-col">
              <span class="os-label !mb-0 text-[8px]">Discord_ID</span>
              <span class="text-xs font-black uppercase tracking-widest text-white">{{
                discord_id() || 'Private'
              }}</span>
            </div>
          </div>
          <div class="os-glass-card social-pill-os group">
            <div class="icon-box"><i class="pi pi-instagram"></i></div>
            <div class="flex flex-col">
              <span class="os-label !mb-0 text-[8px]">IG_Database</span>
              <span class="text-xs font-black uppercase tracking-widest text-white">{{
                instagram() || 'Private'
              }}</span>
            </div>
          </div>
          <div class="os-glass-card social-pill-os group">
            <div class="icon-box"><i class="pi pi-facebook"></i></div>
            <div class="flex flex-col">
              <span class="os-label !mb-0 text-[8px]">Facebook_Link</span>
              <span class="text-xs font-black uppercase tracking-widest text-white">{{
                facebook() || 'Private'
              }}</span>
            </div>
          </div>
          <div class="os-glass-card social-pill-os group">
            <div class="icon-box"><i class="pi pi-envelope"></i></div>
            <div class="flex flex-col overflow-hidden">
              <span class="os-label !mb-0 text-[8px]">Contact_Signal</span>
              <span class="text-xs font-black uppercase tracking-widest text-white truncate">{{
                contact_email() || 'Private'
              }}</span>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
</div>
