<div class="profile-container selection:bg-accent selection:text-white">
  <div class="bg-mesh"></div>
  <div class="tech-grid"></div>

  <div class="max-w-4xl mx-auto px-6 py-12 md:py-24 relative z-10 animate-shuttle">
    <!-- Header: Compact Identity Header -->
    <header class="flex flex-col md:flex-row items-center gap-10 mb-12">
      <div class="avatar-frame-elite">
        <img [src]="avatar_url()" class="animate-shuttle" alt="Operative" />
        @if (isOwnProfile()) {
          <button (click)="openAvatarDialog()" class="avatar-edit-btn" title="Update Profile Image">
            <i class="pi pi-camera"></i>
          </button>
        }
        <!-- Neural Pulse decoration -->
        <div class="absolute -inset-1 rounded-[40px] border border-accent/20 neural-pulse"></div>
      </div>

      <div class="flex-grow text-center md:text-left space-y-4">
        <div class="flex flex-col md:flex-row md:items-center gap-4">
          <h1
            class="text-4xl md:text-6xl font-black text-white italic tracking-tighter leading-none m-0"
          >
            {{ display_name() }}
          </h1>
          <span
            class="text-[10px] font-black text-accent uppercase tracking-[0.4em] bg-accent/5 px-4 py-1.5 rounded-full border border-accent/20 w-max mx-auto md:mx-0"
          >
            RANK: {{ rank() }}
          </span>
        </div>

        <div class="flex flex-wrap justify-center md:justify-start gap-4">
          <div
            class="flex items-center gap-2 text-[10px] font-black text-white/30 uppercase tracking-[0.2em]"
          >
            <div
              class="w-1.5 h-1.5 rounded-full bg-accent shadow-[0_0_8px_var(--accent-glow)]"
            ></div>
            VIBE_SYNC: ACTIVE
          </div>
          <div
            class="flex items-center gap-2 text-[10px] font-black text-white/20 uppercase tracking-[0.2em]"
          >
            <i class="pi pi-shield-check"></i>
            IDENTITY_VERIFIED
          </div>
        </div>

        <div class="pt-4 flex justify-center md:justify-start gap-3">
          @if (isOwnProfile()) {
            <button
              class="btn btn-primary btn-sm !px-8 !rounded-xl !font-black !tracking-widest"
              (click)="openEditProfileDialog()"
            >
              EDIT_PROFILE
            </button>
          } @else {
            @if (friendshipStatus() === 'accepted') {
              <button
                class="btn btn-primary btn-sm !px-8 !rounded-xl !font-black !tracking-widest"
                (click)="openChat()"
              >
                OPEN_CHANNEL
              </button>
            } @else if (friendshipStatus() === 'pending') {
              <button
                class="btn btn-ghost btn-sm !px-8 !rounded-xl !font-black !tracking-widest opacity-40 cursor-wait"
              >
                UPLINK_PENDING
              </button>
            } @else {
              <button
                class="btn btn-primary btn-sm !px-8 !rounded-xl !font-black !tracking-widest"
                (click)="addFriend()"
              >
                REQ_SYNC
              </button>
            }
          }
        </div>
      </div>
    </header>

    <div class="stagger space-y-8">
      <!-- Bento Stats: Compact Row -->
      <div class="grid grid-cols-3 gap-4">
        <div class="glass-card-elite stat-box-mini group">
          <span class="stat-label">TOTAL_SYNC</span>
          <div class="stat-value">{{ stats().hosted + stats().joined }}</div>
          <div class="stat-glow"></div>
        </div>
        <div class="glass-card-elite stat-box-mini group">
          <span class="stat-label">HOSTED</span>
          <div class="stat-value text-accent!">{{ stats().hosted }}</div>
          <div class="stat-glow !bg-accent/10"></div>
        </div>
        <div class="glass-card-elite stat-box-mini group">
          <span class="stat-label">JOINED</span>
          <div class="stat-value">{{ stats().joined }}</div>
          <div class="stat-glow"></div>
        </div>
      </div>

      <!-- Manifesto: Compact Style -->
      <div class="manifesto-card-mini group">
        <div class="absolute inset-0 bg-gradient-to-br from-accent/5 to-transparent"></div>
        <div class="relative z-10">
          <span
            class="text-[9px] font-black uppercase tracking-[0.4em] text-accent/60 mb-4 block underline underline-offset-8 decoration-accent/30"
            >Personal Manifesto</span
          >
          <p
            class="text-xl md:text-3xl font-black italic tracking-tight text-white/90 leading-tight"
          >
            "{{ bio() || 'Scanning for signal... Operative has not established a manifesto yet.' }}"
          </p>

          <div class="flex items-center gap-6 mt-10">
            <div class="flex items-center gap-3">
              <div class="flex gap-1">
                <div class="w-1 h-3 bg-accent rounded-sm animate-pulse"></div>
                <div
                  class="w-1 h-3 bg-accent rounded-sm animate-pulse"
                  style="animation-delay: 0.1s"
                ></div>
                <div class="w-1 h-3 bg-accent/20 rounded-sm"></div>
                <div class="w-1 h-3 bg-accent/20 rounded-sm"></div>
              </div>
              <span class="text-[9px] font-black text-white/20 uppercase tracking-[0.2em]"
                >Signal Strength</span
              >
            </div>
            <div class="h-4 w-[1px] bg-white/5"></div>
            <span class="text-[9px] font-black text-white/20 uppercase tracking-[0.2em]"
              >Uplink Time: 0.2ms</span
            >
          </div>
        </div>
      </div>

      <!-- Social Grid: Compact 2x2 or 4x1 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="social-item-compact group">
          <div class="social-icon"><i class="pi pi-discord"></i></div>
          <div class="flex flex-col">
            <span class="label">DISCORD</span>
            <span class="value">{{ discord_id() || 'SIGNAL_LOST' }}</span>
          </div>
        </div>
        <div class="social-item-compact group">
          <div class="social-icon"><i class="pi pi-instagram"></i></div>
          <div class="flex flex-col">
            <span class="label">INSTAGRAM</span>
            <span class="value">{{ instagram() || 'ENCRYPTED' }}</span>
          </div>
        </div>
        <div class="social-item-compact group">
          <div class="social-icon"><i class="pi pi-facebook"></i></div>
          <div class="flex flex-col">
            <span class="label">FACEBOOK</span>
            <span class="value">{{ facebook() || 'NO_RECORD' }}</span>
          </div>
        </div>
        <div class="social-item-compact group">
          <div class="social-icon"><i class="pi pi-envelope"></i></div>
          <div class="flex flex-col">
            <span class="label">CONTACT</span>
            <span class="value">{{ contact_email() || 'P2P_ONLY' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
